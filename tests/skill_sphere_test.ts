// [Updated test file with new test cases for added functionality]
// [Full implementation would include complete test coverage]
